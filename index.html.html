<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar Installation Professionals | Get Free Quotes</title>
    <meta name="description" content="Connect with top-rated solar installation professionals. Get free quotes for residential and commercial solar panel installation.">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
        }
        
        header {
            background: linear-gradient(135deg, #ff7e30 0%, #ff5f00 100%);
            color: white;
            padding: 40px 0;
            text-align: center;
            margin-bottom: 30px;
            border-radius: 0 0 10px 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .main-content {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .main-content h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        
        .action-btn {
            background: linear-gradient(135deg, #ff7e30 0%, #ff5f00 100%);
            color: white;
            border: none;
            padding: 18px 35px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 126, 48, 0.4);
            margin: 20px 0;
            display: inline-block;
        }
        
        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 126, 48, 0.5);
        }
        
        .action-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }
        
        .info-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            margin-bottom: 30px;
        }
        
        .info-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }
        
        .info-section p {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .benefits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .benefit-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border-left: 4px solid #ff7e30;
        }
        
        .benefit-card h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        footer {
            text-align: center;
            padding: 25px;
            background: #2c3e50;
            color: white;
            border-radius: 10px 10px 0 0;
            margin-top: 40px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            background: #ff6b6b;
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            z-index: 1000;
            opacity: 0;
            transform: translateY(-30px);
            transition: all 0.4s ease;
            max-width: 350px;
        }
        
        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .notification.success {
            background: #4ecdc4;
        }
        
        .loader {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
            vertical-align: middle;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            header h1 {
                font-size: 2rem;
            }
            
            .main-content {
                padding: 25px;
            }
            
            .benefits-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="notification" id="notification"></div>
    
    <header>
        <div class="container">
            <h1>Solar Installation Professionals</h1>
            <p>Connect with top-rated solar installers and get free quotes for your project</p>
        </div>
    </header>
    
    <div class="container">
        <section class="main-content">
            <h2>Find Solar Installers Near You</h2>
            <p>Click the button below to connect with certified solar professionals and get free quotes:</p>
            
            <button class="action-btn" id="solarBtn">
                <span id="btnText">Get Solar Quotes Now</span>
            </button>
            
            <p>We'll connect you with the best local solar installers for your needs</p>
        </section>
        
        <section class="info-section">
            <h3>Why Choose Solar?</h3>
            <p>Solar energy can reduce your electricity bills, increase your property value, and help protect the environment. Our network of certified solar installers can help you find the right solution for your home or business.</p>
            
            <div class="benefits-grid">
                <div class="benefit-card">
                    <h4>Save Money</h4>
                    <p>Reduce your electricity bills by up to 70% with solar energy</p>
                </div>
                <div class="benefit-card">
                    <h4>Increase Home Value</h4>
                    <p>Homes with solar panels sell for more than those without</p>
                </div>
                <div class="benefit-card">
                    <h4>Environment Friendly</h4>
                    <p>Reduce your carbon footprint with clean, renewable energy</p>
                </div>
            </div>
            
            <h3>How It Works</h3>
            <p>1. Click the button above to get started</p>
            <p>2. We'll connect you with top-rated solar installers in your area</p>
            <p>3. Receive free quotes and compare options</p>
            <p>4. Choose the best installer for your project</p>
        </section>
    </div>
    
    <footer>
        <div class="container">
            <p>Â© 2024 Solar Installation Professionals. All rights reserved.</p>
            <p>Contact us: info@solarinstallerpro.com</p>
        </div>
    </footer>

    <script>
        // Cloudflare Worker URL - REPLACE WITH YOUR ACTUAL WORKER URL
        const WORKER_URL = 'https://new-worker-code.shoaibsoftengr99.workers.dev';
        
        // Show notification
        function showNotification(message, isError = true) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.background = isError ? '#ff6b6b' : '#4ecdc4';
            notification.className = isError ? 'notification show' : 'notification show success';
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // Create a hidden iframe to establish solarinstallerpro.com as referrer
        function createReferrerFrame() {
            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            iframe.src = 'https://solarinstallerpro.com/referrer-establish';
            document.body.appendChild(iframe);
            return iframe;
        }
        
        // Call the Cloudflare Worker to get the redirect URL using GET method
        async function callWorker() {
            try {
                // Add timestamp to prevent caching
                const response = await fetch(`${WORKER_URL}/redirect?t=${Date.now()}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`Worker responded with status: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.success && data.redirectUrl) {
                    return data.redirectUrl;
                } else {
                    throw new Error(data.error || 'Failed to get redirect URL from worker');
                }
            } catch (error) {
                console.error('Error calling worker:', error);
                throw error;
            }
        }
        
        // Redirect using form submit to preserve referrer
        function redirectWithForm(url) {
            // Show notification
            showNotification('Connecting you with solar installers...', false);
            
            // Create a form to submit with POST method
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = url;
            form.style.display = 'none';
            
            document.body.appendChild(form);
            
            // Use setTimeout to ensure the notification is visible
            setTimeout(() => {
                form.submit();
            }, 1500);
        }
        
        // Redirect using GET method (for direct navigation)
        function redirectWithGet(url) {
            // Show notification
            showNotification('Redirecting to solar installers...', false);
            
            // Use setTimeout to ensure the notification is visible
            setTimeout(() => {
                window.location.href = url;
            }, 1500);
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            const button = document.getElementById('solarBtn');
            const btnText = document.getElementById('btnText');
            let referrerFrame = null;
            
            // Create the referrer iframe early to establish the referrer
            setTimeout(() => {
                referrerFrame = createReferrerFrame();
            }, 1000);
            
            button.addEventListener('click', async function() {
                const originalText = btnText.textContent;
                
                // Show loading state
                btnText.innerHTML = '<span class="loader"></span> Processing...';
                button.disabled = true;
                
                try {
                    // Call the worker to get the redirect URL
                    const targetUrl = await callWorker();
                    
                    // Use the redirect method that will show solarinstallerpro.com as referrer
                    redirectWithForm(targetUrl);
                } catch (error) {
                    console.error('Redirect failed:', error);
                    btnText.textContent = originalText;
                    button.disabled = false;
                    
                    // Show error notification
                    showNotification('Connection failed. Please try again.');
                }
            });
        });
    </script>
</body>
</html>
